version: 2

models:
  - name: int_weekly_customers_churned_customers
    description: >
      churned_customers = customers who were active prev week but not this week.
      active_customers_prev_week = customers who were present in prev week.
      
    tests:
      - dbt_utils.expression_is_true:
          expression: churned_customers <= active_customers_prev_week
    columns:
      - name: week
        tests:
          - not_null
          - unique
