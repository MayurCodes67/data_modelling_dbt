version: 2

models:
  - name: int_weekly_customers_retained_customers
    description: >
      retained_customers = customers who were active both prev week and this week.
      active_customers_prev_week = customers who were present in prev week.
      
    tests:
      - dbt_utils.expression_is_true:
          expression: retained_customers <= active_customers_prev_week
    columns:
      - name: week
        tests:
          - not_null
          - unique
